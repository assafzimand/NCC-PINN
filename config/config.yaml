problem: schrodinger
architecture: [2, 100, 100, 100, 100, 100, 2]
activation: tanh
epochs: 10000
batch_size: 512
lr: 0.0001

# Optimizer settings
optimizer_switch_at: 0.9  # Switch from Adam to LBFGS (0=LBFGS only, 1=Adam only)

# Adam hyperparameters
adam_betas: [0.9, 0.999]
adam_eps: 0.00000001

# LBFGS hyperparameters
lbfgs_lr: 1.0  # LBFGS typically uses lr=1.0
lbfgs_max_iter: 30  # Reduced from 20 for faster training
lbfgs_history_size: 20
lbfgs_line_search: 'strong_wolfe'  # or null
lbfgs_tolerance_grad: 0.000000000000001  # Relaxed from 0.0000001
lbfgs_tolerance_change: 0.000000000000001  # Relaxed from 0.000000001

cuda: true
eval_only: false

# resume_from: single checkpoint (string) or multiple checkpoints (dict)
# Single checkpoint:
resume_from: null

# Multiple checkpoints (multi-eval mode, requires eval_only: true):
# resume_from:
#   2-200-200-200-200-200-2: "outputs/experiments/5_layers_mid_size_200_different_mid_structure_symmetric_lr0.0001_ep6000_bs512_bins5_20251120_053338/schrodinger_layers-2-200-200-200-200-200-2_act-tanh/checkpoints/final_model.pt"
#   2-200-200-150-200-200-2: "outputs/experiments/5_layers_mid_size_200_different_mid_structure_symmetric_lr0.0001_ep6000_bs512_bins5_20251120_053338/schrodinger_layers-2-200-200-150-200-200-2_act-tanh/checkpoints/final_model.pt"
#   2-200-150-100-150-200-2: "outputs/experiments/5_layers_mid_size_200_different_mid_structure_symmetric_lr0.0001_ep6000_bs512_bins5_20251120_053338/schrodinger_layers-2-200-150-100-150-200-2_act-tanh/checkpoints/final_model.pt"
#   2-100-200-200-200-100-2: "outputs/experiments/5_layers_mid_size_200_different_mid_structure_symmetric_lr0.0001_ep6000_bs512_bins5_20251120_053338/schrodinger_layers-2-100-200-200-200-100-2_act-tanh/checkpoints/final_model.pt"

bins: 5

# training control
print_every: 500  # print training info every N epochs
save_every: 0  # save checkpoint every N epochs
ncc_eval_every: 0  # run NCC analysis every N epochs (0 = only at end)

# reproducibility
seed: 42

# problem-specific domains and loss weights
schrodinger:
  spatial_dim: 1
  spatial_domain: [[-5.0, 5.0]]  # list of [min, max] for each spatial dimension
  temporal_domain: [0.0, 1.5707963267948966]  # [min, max] for time (Ï€/2)
  loss_weights:
    residual: 1.0
    ic: 1.0
    bc: 1.0

problem2:
  spatial_dim: 1
  spatial_domain: [[0.0, 1.0]]
  temporal_domain: [0.0, 1.0]
  loss_weights:
    residual: 1.0
    ic: 1.0
    bc: 1.0

# dataset sizes
n_residual_train: 20000
n_initial_train: 50
n_boundary_train: 50
n_residual_eval: 1000
n_initial_eval: 20
n_boundary_eval: 20

# NCC dataset (uniform sampling - equal samples per non-empty class)
n_samples_ncc: 5000  # total samples, divided equally among non-empty classes

